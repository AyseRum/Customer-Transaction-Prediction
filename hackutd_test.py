# -*- coding: utf-8 -*-
"""HackUTD_Test.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1yoyl1Is39posUuNltSpoeImyh3yowcGy
"""

from __future__ import print_function

# other imports
import numpy as np
import pandas as pd
import os
import json
import pickle
import cv2
import lightgbm as lgb
import xgboost as xgb
import gc
gc.enable()

# Load the Drive helper and mount
from google.colab import drive

# This will prompt for authorization.
drive.mount('/content/drive')

!ls "/content/drive/My Drive/Coding_Exercise/Kaggle/Santander"

print ("[INFO] loading the classifier...")
lgb_path = '/content/drive/My Drive/Coding_Exercise/Kaggle/Santander/models/lgb_models_stack/'
train_labels = ['0', '1']

test 		= pd.read_csv('/content/drive/My Drive/Coding_Exercise/Kaggle/Santander/data/test.csv')

x = test[test['ID_code'] == 'test_0']
x.drop(['ID_code'], axis=1, inplace=True)

lgb_models = sorted(os.listdir(lgb_path))
lgb_result = 0
for m_name in lgb_models:
        #Load LightGBM Model
        model = lgb.Booster(model_file='{}{}'.format(lgb_path, m_name))
        lgb_result += model.predict(x.values)

lgb_result /= len(lgb_models)

print(lgb_result)